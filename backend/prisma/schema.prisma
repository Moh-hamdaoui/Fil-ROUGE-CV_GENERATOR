// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Player {
  id             Int               @id @default(autoincrement())
  firstName      String
  lastName       String
  nationality    String
  secondaryNationality String?
  dateOfBirth    DateTime
  email          String            @unique
  telephone      String
  strongFoot     String
  size           Int
  weight         Int
  vma            Int?
  primaryPost    String
  secondaryPost  String?
  photo          String?
  linkVideo      String?
  linkStats      String?

  favoriteTactic String            @default("4-4-3")

  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt

  requests       Request[]
  qualities      PlayerQualities[]
  careers        Career[]
  formations     Formation[]
}

model Request {
  id         Int      @id @default(autoincrement())
  playerId   Int
  isTreated  Boolean  @default(false)

  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt

  player     Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
}

model Club {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  logo        String?
  foundedYear Int?

  careers     Career[]
}

model PlayerQualities {
  id       Int    @id @default(autoincrement())
  playerId Int
  player   Player @relation(fields: [playerId], references: [id], onDelete: Cascade)
  category String
  quality  String 

  @@index([playerId])
}

model Career {
  id           Int      @id @default(autoincrement())
  playerId     Int
  clubId       Int
  season       String
  competition  String
  startDate    DateTime
  endDate      DateTime?
  isInternationalPlayer  Boolean  @default(false)
  aboutInternationalSelection  String?
  internationalTeamName  String?
  category    String?
  isCaptain   Boolean  @default(false)
  isChampionWinner  Boolean  @default(false)
  nameOfChampionship  String?

  player       Player   @relation(fields: [playerId], references: [id], onDelete: Cascade)
  club         Club     @relation(fields: [clubId], references: [id], onDelete: Cascade)
  stats        Stats?   @relation
  
  clubLogo     String?    
  competitionLogo String? 

  @@index([playerId])
  @@index([clubId])
}

model Stats {
  id        Int     @id @default(autoincrement())
  careerId  Int     @unique
  matches   Int     @default(0)
  goals     Int     @default(0)
  assists  Int     @default(0)
  cleanSheet Int?
  averagePlayingTime Int    @default(0)

  career    Career @relation(fields: [careerId], references: [id], onDelete: Cascade)
}

model Formation {
  id          Int     @id @default(autoincrement())
  playerId    Int
  institution String
  startYear   Int
  endYear     Int
  diploma     String

  player      Player  @relation(fields: [playerId], references: [id], onDelete: Cascade)

  @@index([playerId])
}